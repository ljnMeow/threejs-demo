import{S as k,w as G,K as $,x as N,P as V,W as I,O as Y,h as q,e as K,p as x,o as U,E as X,n as Z}from"./three-cea84195.js";import{S as D}from"./stats.js-e9b58a7b.js";import{g as C}from"./gsap-10963069.js";import{g as r}from"./utils-157cc910.js";import{d as J,a as b,n as Q,b as S,k as v,t as ee,m as te,F as se,o as L}from"./@vue-aea57c88.js";import{_ as oe}from"./index-a2fec666.js";import"./vue-router-2ef0d3d1.js";import"./axios-08622986.js";const ne={class:"box"},ie={key:0,class:"mask"},ae=J({__name:"modelDecomposition",setup(le){const o=b(null);let a=new k,i,l,c,p,w,s=null;const j=new G,P=new $;let m,d;const E={chassis:r("chassis/CUSTOM GAMING PC.glb"),car:r("car/car.glb")},f=[],g=b(!1),y=b();Q(()=>{M(),O(o.value.clientWidth,o.value.clientHeight),z(o.value.clientWidth,o.value.clientHeight),R(),_(),W(),F(),B(),h("chassis"),o.value.addEventListener("dblclick",()=>{s!=null&&s.decomposition?(s.decomposition=!1,s==null||s.traverse(t=>{const e=t;C.to(e.position,{x:e.fromPosition.x,y:e.fromPosition.y,z:e.fromPosition.z,ease:"Power2.inOut",duration:5})})):(s.decomposition=!0,s==null||s.traverse(t=>{const e=t;C.to(e.position,{x:e.toPosition.x,y:e.toPosition.y,z:e.toPosition.z,ease:"Power2.inOut",duration:5})}))})});const M=()=>{a=new k;const t=[r("sky/px.jpg"),r("sky/nx.jpg"),r("sky/py.jpg"),r("sky/ny.jpg"),r("sky/pz.jpg"),r("sky/nz.jpg")];w=new N().load(t),a.background=w},O=(t,e)=>{i=new V(75,t/e,1,1e3),i.position.set(0,0,20),a.add(i)},z=(t,e)=>{l=new I,l.setSize(t,e),o.value.appendChild(l.domElement),l.render(a,i)},W=()=>{p=new D,o.value.appendChild(p.dom)},R=()=>{c=new Y(i,l.domElement),c.enableDamping=!0,c.enableZoom=!0,c.autoRotate=!1,c.enablePan=!0},_=()=>{c.update(),l.render(a,i),p&&p.update(),m&&m.render(),requestAnimationFrame(_)},F=()=>{const t=new q(new K("rgb(255, 255, 255)"));a.add(t)},h=t=>{const e=E[t];s&&(s.visible=!1);let n=H();n?(n.visible=!0,s=n):T(e)},H=()=>{for(let t=0;t<f.length;t++){const e=f[t];if(!e.visible&&e!==s)return e}return null},T=t=>{j.load(t,e=>{e.scene.rotateY(-.2),e.scene.traverse(n=>{const u=n;u.fromPosition=u.position.clone(),u.toPosition=u.position.clone().multiplyScalar(3)}),s=e.scene,s.decomposition=!1,f.push(s),a.add(s)},e=>{const n=Math.min(e.loaded/e.total*100,100);console.log(`模型加载进度：${n}%`),y.value=`模型加载进度：${n.toFixed(2)}%`,n===100?setTimeout(()=>{g.value=!1},800):g.value=!0})},A=t=>{const e=new x;if(!o.value)return;e.x=t.clientX/o.value.clientWidth*2-1,e.y=-(t.clientY/o.value.clientHeight)*2+1,P.setFromCamera(e,i);const n=P.intersectObjects(a.children);if(n.length>0){const u=n[0].object;d.selectedObjects=[u]}else d.selectedObjects=[]},B=()=>{d=new U(new x(o.value.clientWidth,o.value.clientHeight),a,i),d.visibleEdgeColor.set(16711680),d.edgeStrength=10,m=new X(l),m.addPass(new Z(a,i)),m.addPass(d)};return window.addEventListener("mousemove",A,!1),window.addEventListener("resize",()=>{i.aspect=o.value.clientWidth/o.value.clientHeight,i.updateProjectionMatrix(),l.setSize(o.value.clientWidth,o.value.clientHeight),l.setPixelRatio(window.devicePixelRatio)}),(t,e)=>(L(),S(se,null,[v("div",ne,[v("button",{onClick:e[0]||(e[0]=n=>h("chassis"))},"模型一"),v("button",{onClick:e[1]||(e[1]=n=>h("car"))},"模型二")]),v("div",{id:"canvas",ref_key:"canvas",ref:o},null,512),g.value?(L(),S("div",ie,ee(y.value),1)):te("",!0)],64))}});const ge=oe(ae,[["__scopeId","data-v-79a11853"]]);export{ge as default};
